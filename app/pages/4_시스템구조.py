# pages/4_ì‹œìŠ¤í…œ êµ¬ì¡°.py
# ğŸ“¦ AIoT ìŠ¤ë§ˆíŠ¸ ì¸í”„ë¼ ëŒ€ì‹œë³´ë“œ â€” ì‹œìŠ¤í…œ êµ¬ì¡° & ë°ì´í„° íë¦„ ì•ˆë‚´ í˜ì´ì§€
# - ê¸°ì¡´ "4ì‚¬ë¶„ë©´" í˜ì´ì§€ë¥¼ ëŒ€ì²´í•˜ëŠ” ë¬¸ì„œ/ê°€ì´ë“œìš© í˜ì´ì§€
# - app.pyì™€ ë™ì¼í•œ í†¤/ìŠ¤íƒ€ì¼ ì¼ë¶€ ì°¨ìš©

from __future__ import annotations
import sys
from pathlib import Path
import streamlit as st
import pandas as pd

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ê¸°ë³¸ ì„¤ì • & ìŠ¤íƒ€ì¼
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.set_page_config(page_title="ì‹œìŠ¤í…œ êµ¬ì¡° | AIoT ìŠ¤ë§ˆíŠ¸ ì¸í”„ë¼ ëŒ€ì‹œë³´ë“œ", layout="wide")

st.markdown("""
<style>
.katex-display { text-align: left !important; margin-left: 0 !important; }
.block-container { text-align: left !important; }
div[data-testid="stMarkdownContainer"] .katex-display { text-align: left !important; margin-left: 0 !important; margin-right: auto !important; }
div[data-testid="stMarkdownContainer"] .katex-display > .katex { display: inline-block !important; }
div[data-testid="stMarkdownContainer"] p { text-align: left !important; margin-left: 0 !important; }
.small-muted { color: #7a7a7a; font-size: 0.9rem; }
.kpi-card { padding: 16px; border-radius: 16px; background: #111827; border: 1px solid #1f2937; }
.kpi-title { font-size: 0.9rem; color: #9ca3af; margin-bottom: 8px; }
.kpi-value { font-size: 1.2rem; font-weight: 700; color: #e5e7eb; }
.section-title { font-size: 1.1rem; font-weight: 700; margin-bottom: 8px; }
hr.soft { border: none; height: 1px; background: #1f2937; margin: 16px 0; }
</style>
""", unsafe_allow_html=True)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ê²½ë¡œ ìƒìˆ˜
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
BASE_DIR = Path(__file__).resolve().parents[1]  # repo root ì¶”ì •
DATA_DIR = BASE_DIR / "data"
ASSETS_DIR = BASE_DIR / "assets"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# í—¤ë”
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.title("ğŸ— AIoT ìŠ¤ë§ˆíŠ¸ ì¸í”„ë¼ ëŒ€ì‹œë³´ë“œ â€” ì‹œìŠ¤í…œ êµ¬ì¡°")
st.caption("ë³¸ í˜ì´ì§€ëŠ” ê°œë°œì/ìš´ì˜ìë¥¼ ìœ„í•œ **í´ë” êµ¬ì¡°, ë°ì´í„° íŒŒì´í”„ë¼ì¸, ìºì‹œ ì „ëµ, í™•ì¥ í¬ì¸íŠ¸**ë¥¼ ìš”ì•½í•©ë‹ˆë‹¤.")

# í´ë” êµ¬ì¡° ì´ë¯¸ì§€ê°€ ìˆìœ¼ë©´ í‘œì‹œ (ì˜ˆ: assets/structure.png)
img_candidates = [
    ASSETS_DIR / "structure.png",
    ASSETS_DIR / "folder-structure.png",
    ASSETS_DIR / "tree.png",
]
img_path = next((p for p in img_candidates if p.exists()), None)
if img_path:
    st.image(str(img_path), caption="í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡° (assets ë‚´ ì´ë¯¸ì§€ ìë™ íƒìƒ‰)")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 1) ì „ì²´ í´ë” íŠ¸ë¦¬ & ì—­í• 
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### 1) ì „ì²´ í´ë” íŠ¸ë¦¬")
st.code(f"""
{BASE_DIR.name}/
â”œâ”€ app.py                        # 4ì‚¬ë¶„ë©´ ë©”ì¸ ëŒ€ì‹œë³´ë“œ (ì§€ë„Â·ë§í¬í˜¼ì¡Â·ì‹œë‚˜ë¦¬ì˜¤)
â”œâ”€ data/                         # ì›ë³¸/ì „ì²˜ë¦¬ ë°ì´í„° (CSV/XLSX/SHP ë“±)
â”‚   â”œâ”€ seoul_redev_projects.csv
â”‚   â”œâ”€ AverageSpeed(LINK).xlsx
â”‚   â”œâ”€ AverageSpeed(LINK)_2023.csv
â”‚   â”œâ”€ TrafficVolume_Seoul_2023.csv
â”‚   â””â”€ seoul_link_lev5.5_2023.shp
â”œâ”€ utils/                        # ë°ì´í„° ì „ì²˜ë¦¬Â·ì‹œê°í™” ìœ í‹¸
â”‚   â”œâ”€ traffic_preproc.py        # ensure_speed_csv ë“± CSV ë³€í™˜/ì •ì œ
â”‚   â””â”€ traffic_plot.py           # plot_speed / plot_nearby_speed_from_csv
â”œâ”€ components/                   # UI ì»´í¬ë„ŒíŠ¸(ì‚¬ì´ë“œë°” ê°€ì´ë“œ/í”„ë¦¬ì…‹ ë“±)
â”‚   â”œâ”€ sidebar_presets.py
â”‚   â””â”€ sidebar_4quadrant_guide.py
â”œâ”€ pages/                        # ë¬¸ì„œ/ê°€ì´ë“œ ì„œë¸Œ í˜ì´ì§€
â”‚   â””â”€ 4_ì‹œìŠ¤í…œ êµ¬ì¡°.py          # (í˜„ì¬ í˜ì´ì§€) ì‹œìŠ¤í…œ êµ¬ì¡° ê°€ì´ë“œ
â””â”€ assets/                       # (ì„ íƒ) ë¬¸ì„œ ì´ë¯¸ì§€Â·ì•„ì´ì½˜ ë“±
""".strip(), language="text")

st.markdown("### 2) ëª¨ë“ˆë³„ í•µì‹¬ ì—­í• ")
cols = st.columns(5)
with cols[0]:
    st.markdown("**`app.py`**")
    st.write("- 4ì‚¬ë¶„ë©´ UI ë©”ì¸\n- êµí†µ/ì§€ë„/í˜¼ì¡ ê³„ì‚°\n- ì‹œë‚˜ë¦¬ì˜¤Â·ë¯¼ê°ë„Â·í™•ë¥  íƒ­")
with cols[1]:
    st.markdown("**`components/`**")
    st.write("- ì‚¬ì´ë“œë°” í”„ë¦¬ì…‹/ê°€ì´ë“œ\n- ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI ë¸”ë¡")
with cols[2]:
    st.markdown("**`pages/`**")
    st.write("- ì‚¬ìš©ì/ìš´ì˜ì ë¬¸ì„œ\n- êµ¬ì¡°/ê°€ì´ë“œ/ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ ë“±")
with cols[3]:
    st.markdown("**`utils/`**")
    st.write("- ë°ì´í„° ì „ì²˜ë¦¬/ì •ì œ\n- ë§í¬ ì†ë„ ì‹œê°í™” í•¨ìˆ˜")
with cols[4]:
    st.markdown("**`data/`**")
    st.write("- ì›ì²œÂ·ì „ì²˜ë¦¬ ì‚°ì¶œë¬¼\n- Shapefile/CSV/XLSX")

st.divider()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 3) ë°ì´í„° íŒŒì´í”„ë¼ì¸ & ìºì‹œ ì „ëµ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### 3) ë°ì´í„° íŒŒì´í”„ë¼ì¸")

st.markdown("""
1. **ì •ë¹„ì‚¬ì—… ì›ë³¸ ë¡œë“œ â†’ ì •ê·œí™”**
   - `load_raw_projects()` â†’ `normalize_projects()`
   - ì»¬ëŸ¼ ìŠ¤í‚¤ë§ˆ í†µì¼, ìˆ˜ì¹˜í˜•/ë²”ì£¼í˜• ìµœì í™”, ê²°ì¸¡ ë³´ì •
2. **ì¢Œí‘œ ë³‘í•©**
   - `load_coords()`ì—ì„œ `name+gu` ê¸°ì¤€ ì¢Œí‘œ ë³‘í•©
   - ì¢Œí‘œ ëˆ„ë½ ì‹œ êµ¬(å€) ì¤‘ì‹¬ + jittering
3. **êµí†µë°ì´í„° ì¤€ë¹„**
   - `utils.traffic_preproc.ensure_speed_csv(xlsxâ†’csv)` (í•„ìš”ì‹œ ìë™ ë³€í™˜)
   - `utils.traffic_plot.plot_speed(...)` ë˜ëŠ” fallback
4. **í˜¼ì¡ë„ ê³„ì‚°**
   - `compute_congestion_from_speed()`ë¡œ ë§í¬ë³„ `í˜¼ì¡ë„(%)` ê³„ì‚°
   - ì¼í‰ê·  í˜¼ì¡ë„ ì§‘ê³„ â†’ ì§€ë„ GeoJSON ìƒ‰ìƒí™”
5. **ì§€ë„ ë Œë”ë§**
   - `_geojson_cache_store()/get()`ìœ¼ë¡œ ìºì‹œì— GeoJSON ë³´ê´€
   - `st.session_state`ì—ëŠ” **í‚¤ë§Œ ì €ì¥** (ë©”ëª¨ë¦¬ ì ˆê°)
""")

st.markdown("### 4) Streamlit ìºì‹œ ê³„ì¸µ")
st.write("- `@st.cache_resource`: **ëŒ€ìš©ëŸ‰/ë³€ê²½ ë“œë¬¸ ë¦¬ì†ŒìŠ¤** (Shapefile, GeoDataFrame ë“±)")
st.write("- `@st.cache_data`: **ê°€ë²¼ìš´ ë°ì´í„°/ì—°ì‚° ê²°ê³¼** (CSV ë¡œë“œ, ì „ì²˜ë¦¬, ì§‘ê³„ ë“±)")
st.write("- `st.session_state`: **UI ìƒíƒœ** ë° **GeoJSON í‚¤**ë§Œ ì €ì¥í•˜ì—¬ ê°ì²´ ì¤‘ë³µ ë³´ê´€ ë°©ì§€")

with st.container():
    st.markdown("#### ì„¸ì…˜ í‚¤ ìš”ì•½")
    df_keys = pd.DataFrame([
        {"í‚¤": "matched_geo_key_daily", "ì„¤ëª…": "ì¼í‰ê·  í˜¼ì¡ GeoJSON ìºì‹œ í‚¤", "ì˜ˆì‹œ": "1250_41.3_abs"},
        {"í‚¤": "matched_geo_key_hourly","ì„¤ëª…": "(ë¯¸ì‚¬ìš©) ì‹œê°„ëŒ€ í˜¼ì¡ GeoJSON í‚¤", "ì˜ˆì‹œ": "-"},
        {"í‚¤": "color_mode_daily_val",  "ì„¤ëª…": "ì§€ë„ ìƒ‰ ê¸°ì¤€(ì ˆëŒ€/ìƒëŒ€)", "ì˜ˆì‹œ": "ì ˆëŒ€(30/70)"},
        {"í‚¤": "selected_row",          "ì„¤ëª…": "ì„ íƒëœ ë‹¨ì§€(í…Œì´ë¸” ì¸ë±ìŠ¤)", "ì˜ˆì‹œ": "42"},
        {"í‚¤": "selected_gu_prev",      "ì„¤ëª…": "ì´ì „ êµ¬(å€) ì„ íƒ ìƒíƒœ", "ì˜ˆì‹œ": "ê°•ë‚¨êµ¬"},
        {"í‚¤": "eta_by_gu",             "ì„¤ëª…": "êµ¬ë³„ í˜¼ì¡ ë¯¼ê°ë„ Î·", "ì˜ˆì‹œ": "{'ê°•ë‚¨êµ¬':0.75}"},
        {"í‚¤": "df_plot_all",           "ì„¤ëª…": "ë°˜ê²½ ë‚´ ë§í¬ ì†ë„ ì›ë³¸(3-2/3-3 ê³µìœ )", "ì˜ˆì‹œ": "DataFrame"},
        {"í‚¤": "curve_33",              "ì„¤ëª…": "ê¸°ì¤€/ì¬ê±´ì¶•í›„ í˜¼ì¡ ê³¡ì„ (base/after)", "ì˜ˆì‹œ": "DataFrame"},
        {"í‚¤": "auto_defaults",         "ì„¤ëª…": "3-4 íƒ­ ìë™ ê¸°ë³¸ê°’ ë²ˆë“¤", "ì˜ˆì‹œ": "{...}"},
        {"í‚¤": "df_scn_result",         "ì„¤ëª…": "ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ ê²°ê³¼", "ì˜ˆì‹œ": "DataFrame"},
        {"í‚¤": "df_tornado",            "ì„¤ëª…": "ë¯¼ê°ë„(í† ë„¤ì´ë„) í‘œ", "ì˜ˆì‹œ": "DataFrame"},
        {"í‚¤": "mc_p10p50p90",          "ì„¤ëª…": "ëª¬í…Œì¹´ë¥¼ë¡œ P10/P50/P90", "ì˜ˆì‹œ": "(..,..,..)"},
    ])
    st.dataframe(df_keys, use_container_width=True, hide_index=True)

st.divider()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 5) ì£¼ìš” ìƒìˆ˜/ê²½ë¡œ (app.py ê¸°ì¤€)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### 5) ì£¼ìš” ìƒìˆ˜/ê²½ë¡œ")
rows = [
    ("BASE_YEAR", "ê¸°ì¤€ë…„ë„", "2023"),
    ("PROJECTS_CSV_PATH", "ì •ë¹„ì‚¬ì—… ì›ë³¸ CSV", "data/seoul_redev_projects.csv"),
    ("TRAFFIC_XLSX_PATH", "êµí†µ ì†ë„ ì›ë³¸ XLSX", "data/AverageSpeed(LINK).xlsx"),
    ("TRAFFIC_CSV_PATH",  "êµí†µ ì†ë„ CSV(ìƒì„±)", "data/AverageSpeed(LINK)_2023.csv"),
    ("TRAFFIC_VOL_CSV_PATH", "êµí†µ ë³¼ë¥¨ CSV(ì„ íƒ)", "data/TrafficVolume_Seoul_2023.csv"),
    ("SHP_PATH", "ë§í¬ Shapefile", "data/seoul_link_lev5.5_2023.shp"),
    ("LINK_ID_COL", "Shapefile ë§í¬ ID ì»¬ëŸ¼", "k_link_id"),
]
st.table(pd.DataFrame(rows, columns=["ìƒìˆ˜", "ì˜ë¯¸", "ì˜ˆì‹œ ê²½ë¡œ/ê°’"]))

st.divider()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 6) ì„±ëŠ¥ ìµœì í™” ì²´í¬ë¦¬ìŠ¤íŠ¸
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### 6) ì„±ëŠ¥ ìµœì í™” ì²´í¬ë¦¬ìŠ¤íŠ¸")
st.markdown("""
- âœ… **ìºì‹œ**: Shapefile â†’ `@st.cache_resource`, CSV/ì§‘ê³„ â†’ `@st.cache_data`
- âœ… **ì„¸ì…˜ ìµœì†Œí™”**: í° ê°ì²´ ëŒ€ì‹  **í‚¤**ë§Œ `st.session_state`ì— ì €ì¥
- âœ… **dtype ìµœì í™”**: `_downcast_numeric`, `_categorify`ë¡œ ë©”ëª¨ë¦¬ ì ˆê°
- âœ… **ì¬ì‚¬ìš©**: ê³µí†µ ê³„ì‚°(í˜¼ì¡ ë³€í™˜, ì¼í‰ê· , GeoJSON ë¹Œë“œ) í•¨ìˆ˜í™”
- âœ… **ë ˆì´ì•„ì›ƒ ë¶„ë¦¬**: ì§€ë„/ì°¨íŠ¸ ë Œë” ë¸”ë¡ì„ ë¶„ë¦¬í•´ ë¶ˆí•„ìš”í•œ ì¬ê³„ì‚° ìµœì†Œí™”
- âœ… **ë°©ì–´ì  ì½”ë”©**: íŒŒì¼ ë¶€ì¬/ê²°ì¸¡ ì‹œ ì•ˆë‚´ ë©”ì‹œì§€Â·ê¸°ë³¸ê°’ ì œê³µ
""")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 7) í™•ì¥ í¬ì¸íŠ¸
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### 7) í™•ì¥ í¬ì¸íŠ¸")
st.markdown("""
- **êµí†µ í”Œë¡œìš° ëŒ€ì²´/ë³´ê°•**  
  - `utils.traffic_plot.plot_speed` â†” `plot_nearby_speed_from_csv`(fallback)
  - ë‹¤ë¥¸ ê³µê¸‰ì ë°ì´í„°(ì˜ˆ: API)ë¡œ ëŒ€ì²´ ì‹œ ë™ì¼ ìŠ¤í‚¤ë§ˆ(`link_id,hour,í‰ê· ì†ë„`) ë§ì¶”ê¸°
- **í˜¼ì¡ ì¶”ì •ì‹ ì»¤ìŠ¤í„°ë§ˆì´ì§•**  
  - 3-3 ì‚¬ë¶„ë©´ì˜ `w(h)`/`Î·`/`r`(ì„¸ëŒ€ë¹„) ì¡°ì •, ìƒˆë²½ ìŠ¤ë¬´ë”©(`apply_dawn_smoothing`) íŒŒë¼ë¯¸í„° íŠœë‹
- **ì¬ë¬´ ëª¨ë¸ í™•ì¥**  
  - `numpy_financial` í™œìš©í•´ IRR/NPV/ìºì‹œí”Œë¡œìš° ìƒì„¸í™”, í† ì§€ë¹„/ì´ì/ë³´ì¡°ê¸ˆ í•­ëª© ì¶”ê°€
- **ë³´ê³ ì„œ ìƒì„±**  
  - `st.download_button`ìœ¼ë¡œ CSV/PNG/Markdown ë ˆí¬íŠ¸ ë‚´ë³´ë‚´ê¸° íƒ­ ì¶”ê°€
- **ë‹¤ì¤‘ í”„ë¡œì íŠ¸ ë¹„êµ**  
  - ë³µìˆ˜ ë‹¨ì§€ ì„ íƒ í›„ êµí†µÂ·ì¬ë¬´ ê²°ê³¼ë¥¼ ê·¸ë¦¬ë“œ/ìŠ¤ëª°ë©€í‹°í”Œë¡œ ë¹„êµ
""")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 8) ìì£¼ ë¬»ëŠ” ì§ˆë¬¸(FAQ) / íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### 8) íŠ¸ëŸ¬ë¸”ìŠˆíŒ…")
with st.expander("â— êµí†µ CSV ë˜ëŠ” SHPê°€ ì—†ì–´ ê·¸ë˜í”„/ì§€ë„ê°€ ë¹„ì–´ìˆì–´ìš”"):
    st.markdown("""
- `data/`ì— **AverageSpeed(LINK).xlsx**ì™€ **seoul_link_lev5.5_2023.shp**(ì—°ê´€ íŒŒì¼ í¬í•¨)ì„ ë„£ì–´ì£¼ì„¸ìš”.  
- ì•±ì´ ìë™ìœ¼ë¡œ XLSXâ†’CSV(`AverageSpeed(LINK)_2023.csv`) ë³€í™˜ì„ ì‹œë„í•©ë‹ˆë‹¤.
- íŒŒì¼ëª…ì´ ë‹¤ë¥´ë©´ `app.py` ìƒë‹¨ ê²½ë¡œ ìƒìˆ˜ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”.
""")
with st.expander("â— ì¢Œí‘œê°€ ì—†ëŠ” ë‹¨ì§€ë“¤ì´ ìˆì–´ìš”"):
    st.markdown("""
- `data/ì„œìš¸ì‹œ_ì¬ê°œë°œì¬ê±´ì¶•_clean_kakao.csv`ì— `name, gu, lat, lon`ì„ ë³´ì™„í•˜ì„¸ìš”.
- ì¢Œí‘œê°€ ì—†ì–´ë„ ì„ì‹œë¡œ **êµ¬ ì¤‘ì‹¬ + Jitter**ë¡œ ì§€ë„ì— í‘œì‹œë˜ì§€ë§Œ, ë¶„ì„ ì •í™•ë„ëŠ” ë–¨ì–´ì§‘ë‹ˆë‹¤.
""")
with st.expander("â— ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ë†’ì•„ìš” / ëŠë ¤ìš”"):
    st.markdown("""
- ë°˜ê²½/Top-N ìŠ¬ë¼ì´ë”ë¥¼ ë‚®ì¶”ê³ , ë°ì´í„°ì…‹ì„ ì—°ë„/ì§€ì—­ìœ¼ë¡œ ë¶„í• í•˜ì„¸ìš”.
- `@st.cache_*`ê°€ ì˜ ì ìš©ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ëŒ€í˜• ë³€ìˆ˜ì˜ ì„¸ì…˜ ì €ì¥ì„ í”¼í•˜ì„¸ìš”.
""")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 9) ì‹¤í–‰/ë°°í¬ íŒ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("### 9) ì‹¤í–‰ & ë°°í¬")
st.code("""
# ë¡œì»¬ ì‹¤í–‰
$ streamlit run app.py

# (ì„ íƒ) requirements.txtì— ì•„ë˜ì™€ ìœ ì‚¬í•œ ì˜ì¡´ì„± ê¸°ì…
streamlit
pandas
numpy
geopandas
pydeck
altair
numpy-financial
shapely
fiona
""".strip(), language="bash")

st.markdown("<br/>", unsafe_allow_html=True)
st.success("ì´ í˜ì´ì§€ëŠ” ìš´ì˜/ê°œë°œì ì˜¨ë³´ë”©ì„ ìœ„í•œ ë¬¸ì„œ í˜ì´ì§€ì…ë‹ˆë‹¤. ì½”ë“œ/ê²½ë¡œê°€ ë°”ë€Œë©´ **ì—¬ê¸°ë¥¼ ìš°ì„  ì—…ë°ì´íŠ¸** í•´ì£¼ì„¸ìš”.")
